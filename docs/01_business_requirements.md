# Бізнес-вимоги до системи VoP для СЕП НБУ

## 1. Контекст та обґрунтування

### 1.1 Проблема

**Поточний стан:**
- **15-20%** платежів містять помилки в реквізитах отримувача
- **₴2.5+ млрд** збитків щорічно через помилкові перекази
- **72 години** — середній час повернення помилково відправлених коштів
- Збільшення випадків шахрайства через помилкові перекази на чужі рахунки
- Низький рівень довіри до електронних платежів
- Особливо критично для миттєвих переказів (< 10 сек на всю операцію)

**Вплив на бізнес:**
- Фінансові втрати клієнтів: **₴2.5+ млрд/рік**
- Репутаційні ризики для банків та НБУ
- Додаткові операційні витрати на обробку повернень
- Зниження успішності платіжних операцій (особливо миттєвих переказів)

### 1.2 Рішення

Система Verification of Payee (VoP) дозволяє банкам-відправникам перевіряти реквізити отримувачів ПЕРЕД відправленням платежу до СЕП НБУ, забезпечуючи:

✅ Зменшення кількості помилкових платежів
✅ Підвищення успішності операцій
✅ Запобігання шахрайству
✅ Покращення клієнтського досвіду
✅ Зниження операційних витрат банків

**Очікувані результати впровадження:**

| Показник | Поточний стан | Після VoP | Покращення |
|----------|---------------|-----------|------------|
| Платежі з помилками | 15-20% | 3-5% | **-70%** |
| Збитки від помилок | ₴2.5 млрд/рік | ₴1.25 млрд/рік | **-50%** |
| Час повернення коштів | 72 год | < 24 год | **-67%** |
| Шахрайство | Baseline | -30-40% | **-35%** avg |
| Задоволеність клієнтів | Baseline | +15-20% | **+17%** avg |
| Операції повернення | Baseline | -60% | **-60%** |

**Економічний ефект:**
- **Економія для банківської системи: ₴1.25+ млрд/рік**
- **Витрати на впровадження:**
  - НБУ (VoP Router): інфраструктура + команда
  - Банки (APIs): ₴200к-1.5млн на банк (залежно від розміру)
- **ROI (Return on Investment): окупність за 6-12 місяців**

### 1.3 Міжнародний досвід

**UK Confirmation of Payee (CoP):**
- Запущено в 2020 році
- 2+ мільйони перевірок на день
- 400+ фінансових установ підключені
- Зменшення шахрайства на 30%
- Економія £250+ млн на рік
- Обов'язково для всіх великих банків з 2024

**EU Verification of Payee:**
- Регламент 2024/886 — обов'язково з 9 жовтня 2025
- Станом на лютий 2026: **2,673 PSPs + 55 RVM** підключені
- Потенціал: 4,000+ установ мають підключитися по всьому ЄС
- Прогноз 2027: 3,000+ PSPs
- Інтеграція з SEPA Instant Payments
- Використання EPC Directory Service (EDS)

## 2. Бізнес-цілі

### 2.1 Основні цілі

| Ціль | Метрика | Target |
|------|---------|--------|
| Зменшення помилкових платежів | % платежів з невірними реквізитами | Зменшення на 70% |
| Підвищення успішності | % успішних миттєвих переказів | > 95% |
| Запобігання шахрайству | Кількість виявлених шахрайських спроб | +50% виявлення |
| Покращення UX | NPS (Net Promoter Score) | > 8/10 |
| Adoption rate | % банків-учасників | 100% для IP (1 рік) |

### 2.2 Бізнес-переваги

**Для клієнтів (фізичних осіб та бізнесів):**
- ✅ Впевненість у правильності реквізитів
- ✅ Зменшення ризику втрати коштів
- ✅ Швидше виявлення помилок
- ✅ Захист від шахрайства

**Для банків:**
- ✅ Зменшення операційних витрат на повернення
- ✅ Підвищення репутації
- ✅ Зниження ризиків compliance (AML/CFT)
- ✅ Конкурентна перевага

**Для НБУ:**
- ✅ Підвищення надійності СЕП
- ✅ Зменшення кількості скарг
- ✅ Відповідність міжнародним стандартам
- ✅ Розвиток фінтех-екосистеми України

## 3. Функціональні вимоги

### 3.1 UC-01: Перевірка реквізитів перед платежем (основний сценарій)

**Актори:**
- Клієнт-платник
- Банк-відправник (Requester)
- VoP Router
- Банк-отримувач (Responder)

**Передумови:**
- Клієнт авторизований в системі банку
- Банк-відправник підключений до VoP
- Банк-отримувач зареєстрований в VoP Directory

**Основний потік:**
1. Клієнт заповнює форму платежу (IBAN отримувача, ім'я, сума)
2. Клієнт натискає «Перевірити реквізити» або автоматично при введенні IBAN
3. Банк-відправник відправляє VoP Request до Router
4. Router визначає банк-отримувач за IBAN
5. Router направляє запит до банку-отримувача
6. Банк-отримувач перевіряє дані в своїй базі
7. Банк-отримувач виконує name matching
8. Банк-отримувач повертає VoP Response
9. Router передає відповідь банку-відправнику
10. Банк-відправник відображає результат клієнту

**Результат:**
- `MATCH` → «✅ Реквізити підтверджені. ШЕВЧЕНКО ТАРАС ГРИГОРОВИЧ»
- `CLOSE_MATCH` → «⚠️ Можлива помилка в імені. Перевірте: ШЕВЧЕНКО ТАРАС ГРИГОРІЙОВИЧ»
- `NO_MATCH` → «❌ Ім'я не співпадає з рахунком. Перевірте реквізити.»

**Альтернативні потоки:**
- A1: Банк-отримувач не в Directory → повертається `ERROR`
- A2: Timeout (> 3 сек) → повертається `ERROR` + можливість продовжити без VoP
- A3: Рахунок закритий/заблокований → `accountStatus: CLOSED/BLOCKED`

### 3.2 UC-02: Обробка результату MATCH

**Основний потік:**
1. Система відображає «✅ Реквізити підтверджені»
2. Показується перевірене ім'я отримувача
3. Клієнт підтверджує платіж
4. Платіж відправляється до СЕП (pacs.008)

**Бізнес-правила:**
- BR-01: При `MATCH` клієнт може продовжити платіж без додаткових попереджень
- BR-02: Перевірене ім'я відображається для додаткової впевненості

### 3.3 UC-03: Обробка результату CLOSE_MATCH

**Основний потік:**
1. Система відображає «⚠️ Можлива помилка в імені»
2. Показується введене ім'я vs. перевірене ім'я
3. Система пропонує:
   - «Продовжити» (якщо клієнт впевнений)
   - «Виправити» (змінити ім'я)
   - «Скасувати»
4. Якщо клієнт обирає «Продовжити» → додаткове підтвердження

**Приклад:**
```
⚠️ Увага! Можлива помилка в імені отримувача

Ви ввели: ШЕВЧЕНКО ТАРАС ГРИГОРОВИЧ
У банку-отримувачі: ШЕВЧЕНКО ТАРАС ГРИГОРІЙОВИЧ

Різниця: «ГРИГОРОВИЧ» vs «ГРИГОРІЙОВИЧ»

[ Виправити ]  [ Продовжити ]  [ Скасувати ]
```

**Бізнес-правила:**
- BR-03: `CLOSE_MATCH` вимагає додаткового підтвердження від клієнта
- BR-04: Система логує вибір клієнта (для аудиту)

### 3.4 UC-04: Обробка результату NO_MATCH

**Основний потік:**
1. Система відображає «❌ Ім'я не співпадає з рахунком»
2. Рекомендується перевірити реквізити
3. Система пропонує:
   - «Виправити реквізити»
   - «Скасувати платіж»
   - «Продовжити на свій ризик» (з підтвердженням)

**Приклад:**
```
❌ Ім'я не співпадає з рахунком отримувача

Ви ввели: ШЕВЧЕНКО ТАРАС ГРИГОРОВИЧ
IBAN: UA213052990000026007233566001

Можливі причини:
• Помилка в написанні імені
• Невірний IBAN
• Рахунок належить іншій особі

⚠️ Увага! Продовження може призвести до втрати коштів.

[ Виправити реквізити ]  [ Скасувати платіж ]

[ Продовжити на свій ризик ] (requires confirmation)
```

**Бізнес-правила:**
- BR-05: `NO_MATCH` вимагає явного вибору клієнта
- BR-06: Якщо клієнт продовжує → логується warning + згода клієнта
- BR-07: Банк може заборонити продовження при `NO_MATCH` (налаштування)

### 3.5 UC-05: Обробка помилок та недоступності

**Сценарій 1: Timeout**
```
⚠️ Перевірка реквізитів недоступна

Банк-отримувач не відповідає. Ви можете:
• Спробувати ще раз
• Продовжити без перевірки

[ Спробувати ще раз ]  [ Продовжити без перевірки ]
```

**Сценарій 2: Банк не підтримує VoP**
```
ℹ️ Перевірка реквізитів недоступна

Банк-отримувач поки не підтримує перевірку реквізитів.
Платіж буде оброблено як звичайно.

[ Продовжити ]  [ Скасувати ]
```

**Бізнес-правила:**
- BR-08: При `ERROR` клієнт може продовжити платіж (на свій ризик)
- BR-09: При `NOT_SUPPORTED` платіж обробляється як звичайно
- BR-10: Банк логує всі випадки `ERROR` для моніторингу

### 3.6 UC-06: Перевірка бізнес-рахунків

**Відмінності від особистих рахунків:**
- Передається EDRPOU замість РНОКПП
- Name matching для назв компаній (складніше)
- Можливість перевірки через LEI (Legal Entity Identifier)

**Приклад:**
```json
{
  "payee": {
    "iban": "UA213052990000026007233566001",
    "name": "ТОВАРИСТВО З ОБМЕЖЕНОЮ ВІДПОВІДАЛЬНІСТЮ \"ПРИВАТБАНК\"",
    "identificationType": "EDRPOU",
    "identificationCode": "14360570"
  },
  "accountType": "BUSINESS"
}
```

**Бізнес-правила:**
- BR-11: Для бізнес-рахунків обов'язкова наявність EDRPOU
- BR-12: Name matching враховує типи компаній (ТОВ, ПП, АТ тощо)
- BR-13: Банк може вимагати LEI для великих компаній (опційно)

### 3.7 UC-07: Opt-out (відмова від VoP)

**Сценарій:**
Клієнт-отримувач не бажає, щоб його дані перевірялися (приватність).

**Процес:**
1. Клієнт звертається до свого банку (отримувача)
2. Банк реєструє opt-out в системі
3. При VoP запиті → Response: `NOT_SUPPORTED` + `OPTO`

**Приклад відповіді:**
```json
{
  "result": {
    "matchStatus": "NOT_SUPPORTED",
    "reasonCode": "OPTO",
    "reasonDescription": "Client opted out from VoP"
  }
}
```

**Бізнес-правила:**
- BR-14: Opt-out доступний тільки для особистих рахунків (не для бізнесів)
- BR-15: Клієнт може відкликати opt-out в будь-який час
- BR-16: При opt-out платіж обробляється як звичайно (без VoP)

## 4. Нефункціональні вимоги

### 4.1 Performance

| Вимога | Target | Maximum | Пріоритет |
|--------|--------|---------|-----------|
| Латентність (normal) | < 500 мс | 1000 мс | Критичний |
| Латентність (peak) | < 1 сек | 3 сек | Високий |
| Throughput (Router) | 1000 req/sec | - | Високий |
| Uptime | 99.9% | - | Критичний |
| Concurrent users | 10,000+ | - | Середній |

**Обґрунтування:**
- Миттєві перекази мають ліміт 10 сек
- VoP виконується ДО відправки в СЕП → не впливає на 10-сек ліміт
- Але клієнт очікує швидкої відповіді (UX)

### 4.2 Availability

- **24/7 доступність** — система працює цілодобово
- **99.9% uptime** — не більше 8.76 годин downtime на рік
- **Graceful degradation** — при недоступності VoP платіж може бути продовжений

**SLA для банків:**
- Відповідь на VoP запит: < 1 сек (99% випадків)
- Відповідь на VoP запит: < 3 сек (99.9% випадків)
- Uptime: 99.9%

### 4.3 Security

- **mTLS** — взаємна автентифікація
- **OAuth 2.0 + FAPI** — авторизація
- **TLS 1.3** — шифрування
- **QWAC сертифікати** — кваліфіковані сертифікати
- **Rate limiting** — захист від DDoS
- **Audit logging** — логування всіх операцій

### 4.4 Privacy (GDPR)

- **Мінімізація даних** — передача тільки необхідних реквізитів
- **Retention policy** — 90 днів, потім видалення/анонімізація
- **Opt-out** — можливість відмови від VoP
- **Згода клієнта** — інформування про VoP при відкритті рахунку

### 4.5 Scalability

- **Horizontal scaling** — додавання нових instances при навантаженні
- **Auto-scaling** — автоматичне масштабування на основі metrics
- **Caching** — кешування для зменшення навантаження на БД

### 4.6 Usability

- **Інтуїтивний UI** — зрозумілі повідомлення для клієнтів
- **Локалізація** — українська, англійська, російська (опційно)
- **Accessibility** — доступність для людей з обмеженими можливостями
- **Mobile-friendly** — підтримка мобільних пристроїв

## 5. Бізнес-правила

### 5.1 Обов'язковість VoP

- **BR-20:** VoP обов'язковий для всіх миттєвих переказів (Instant Payments)
- **BR-21:** VoP рекомендований для звичайних переказів (Regular Payments)
- **BR-22:** VoP не застосовується для переказів всередині одного банку (on-us)

### 5.2 Name Matching

- **BR-30:** `MATCH` — similarity ≥ 95%
- **BR-31:** `CLOSE_MATCH` — 75% ≤ similarity < 95%
- **BR-32:** `NO_MATCH` — similarity < 75%
- **BR-33:** Регістр не враховується (case-insensitive)
- **BR-34:** Пробіли нормалізуються (trim, multiple spaces → single space)

### 5.3 IBAN Validation

- **BR-40:** IBAN має бути валідним (checksum)
- **BR-41:** IBAN має належати українському банку (UA)
- **BR-42:** Bank code (символи 5-10) має існувати в Directory

### 5.4 Timeout та Retry

- **BR-50:** Timeout VoP запиту: 3 секунди
- **BR-51:** Кількість retry: 1 (тільки при network error)
- **BR-52:** Якщо timeout → клієнт може продовжити без VoP

### 5.5 Audit та Compliance

- **BR-60:** Всі VoP запити логуються (для аудиту)
- **BR-61:** Логи зберігаються 90 днів
- **BR-62:** Доступ до логів тільки для авторизованих користувачів
- **BR-63:** Логи містять: timestamp, requestId, IBAN (замасковано), matchStatus

## 6. Інтеграція з бізнес-процесами

### 6.1 Миттєві перекази (Instant Payments)

```
1. Клієнт ініціює миттєвий переказ
2. VoP перевірка (< 1 сек)
3. Результат VoP відображається клієнту
4. Клієнт підтверджує
5. pacs.008 відправляється до СЕП
6. СЕП обробляє (< 10 сек загалом)
7. pacs.002 повертається
8. Кошти зараховуються на рахунок отримувача
```

**Критично:** VoP НЕ повинна уповільнювати миттєві перекази.

### 6.2 Звичайні перекази (Regular Payments)

```
1. Клієнт ініціює платіж
2. VoP перевірка (< 1 сек)
3. Результат VoP відображається клієнту
4. Клієнт може виправити або підтвердити
5. pacs.008 відправляється до СЕП (пакетна обробка)
6. Платіж виконується протягом доби
```

### 6.3 Корпоративні платежі

- Множинні платежі (pain.001 з багатьма переказами)
- VoP може виконуватися асинхронно
- Результати відображаються в звіті

### 6.4 Інтеграція з AML/CFT

VoP може допомогти виявити підозрілі операції:
- `NO_MATCH` + велика сума → додаткова перевірка
- Часті `NO_MATCH` від одного клієнта → ризик шахрайства

## 7. Метрики успіху

### 7.1 KPI для клієнтів

| Метрика | Базовий рівень | Target (1 рік) |
|---------|---------------|---------------|
| % помилкових платежів | 5-10% | < 2% |
| % успішних миттєвих переказів | 90% | > 95% |
| Customer Satisfaction (CSAT) | 7/10 | > 8.5/10 |
| % клієнтів, що використовують VoP | 0% | > 80% |

### 7.2 KPI для банків

| Метрика | Базовий рівень | Target (1 рік) |
|---------|---------------|---------------|
| Кількість повернень через помилкові реквізити | Baseline | -60% |
| Витрати на обробку повернень | Baseline | -50% |
| % банків-учасників VoP | 0% | 100% (для IP) |
| % VoP запитів з результатом `MATCH` | - | > 85% |

### 7.3 KPI для НБУ

| Метрика | Базовий рівень | Target (1 рік) |
|---------|---------------|---------------|
| % успішних операцій у СЕП | 95% | > 98% |
| Кількість скарг на помилкові платежі | Baseline | -70% |
| Виявлення шахрайства | Baseline | +50% |
| Відповідність міжнародним стандартам | Часткова | Повна (EU VoP) |

## 8. Ризики та обмеження

### 8.1 Бізнес-ризики

| Ризик | Ймовірність | Вплив | Мітигація |
|-------|-------------|-------|-----------|
| Низька adoption rate банків | Середня | Високий | Обов'язковість для IP |
| Опір клієнтів (privacy concerns) | Низька | Середній | Opt-out, прозора комунікація |
| Повільна перевірка (> 3 сек) | Низька | Високий | Performance optimization, SLA |
| False negatives (NO_MATCH для валідних реквізитів) | Середня | Середній | Покращення name matching |

### 8.2 Технічні обмеження

- VoP працює тільки для рахунків в українських банках (IBAN UA)
- VoP не перевіряє sufficiency of funds (достатність коштів)
- VoP не замінює існуючі AML/CFT процедури
- Name matching може давати false positives/negatives

### 8.3 Регуляторні обмеження

- GDPR — необхідність згоди клієнта
- Банківська таємниця — мінімізація передачі даних
- НБУ Resolution — необхідність затвердження НБУ

## 9. Roadmap впровадження

### Фаза 1: Пілот (Q1-Q2 2026)
- 5-10 банків-учасників
- Test Environment
- Збір feedback
- Фокус на миттєвих переказах

### Фаза 2: Розширення (Q3-Q4 2026)
- Обов'язково для всіх учасників IP
- Production Environment
- Моніторинг та оптимізація

### Фаза 3: Mandatory для всіх (Q1-Q2 2027)
- Всі типи переказів
- Додаткові перевірки (LEI, EDRPOU)
- Інтеграція з міжнародними платежами

## 10. Висновки

Система VoP для СЕП НБУ забезпечить:

✅ **Зменшення помилкових платежів** на 70%
✅ **Підвищення успішності** миттєвих переказів до > 95%
✅ **Запобігання шахрайству** (+50% виявлення)
✅ **Покращення клієнтського досвіду** (NPS > 8/10)
✅ **Відповідність міжнародним стандартам** (UK CoP, EU VoP)

---

**Версія:** 1.0
**Дата:** 2026-02-06
**Статус:** Draft
**Автор:** Департамент інформаційних технологій НБУ
